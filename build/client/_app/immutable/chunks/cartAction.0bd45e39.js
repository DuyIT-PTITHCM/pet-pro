import{$ as C,a0 as Q,a1 as o,a2 as S}from"./scheduler.27637a5f.js";import{h as v,t as N,c as O,b as J}from"./index.30573ce1.js";import{H as q}from"./Const.4ee2e7e1.js";import{a as g,c as k}from"./cart.b91b529b.js";import{t as y}from"./toastError.ab1f0c9f.js";import{r as b,s as m,g as d}from"./cookieUtils.9487ed92.js";function I(e,t){const u=t.token={};function r(a,c,i,s){if(t.token!==u)return;t.resolved=s;let n=t.ctx;i!==void 0&&(n=n.slice(),n[i]=s);const l=a&&(t.current=a)(n);let _=!1;t.block&&(t.blocks?t.blocks.forEach((h,p)=>{p!==c&&h&&(v(),N(h,1,1,()=>{t.blocks[p]===h&&(t.blocks[p]=null)}),O())}):t.block.d(1),l.c(),J(l,1),l.m(t.mount(),t.anchor),_=!0),t.block=l,t.blocks&&(t.blocks[c]=l),_&&S()}if(C(e)){const a=Q();if(e.then(c=>{o(a),r(t.then,1,t.value,c),o(null)},c=>{if(o(a),r(t.catch,2,t.error,c),o(null),!t.hasCatch)throw c}),t.current!==t.pending)return r(t.pending,0),!0}else{if(t.current!==t.then)return r(t.then,1,t.value,e),!0;t.resolved=e}}function T(e,t,u){const r=t.slice(),{resolved:a}=e;e.current===e.then&&(r[e.value]=a),e.current===e.catch&&(r[e.error]=a),e.block.p(r,u)}async function $(e){let t=[],u=await JSON.parse(e.images),r={id:e.id,name:e.productName,origin:e.origin,image:q+u[0],url:e.slug,price:e.price,quantity:1,isSelect:!1};g.subscribe(s=>{s&&(t=JSON.parse(s))});var a=t.find(s=>s.id==r.id);a?a.quantity<20?(a.quantity+=1,t.map(s=>s.id===(a==null?void 0:a.id)?a:s),y.set([{message:"Add to cart success",type:"success"}])):y.set([{message:"Quantity can not over than 20",type:"error"}]):(t.push(r),y.set([{message:"Add to cart success",type:"success"}]));let c=t.reduce(function(s,n){return s+n.quantity},0);const i=JSON.stringify(t);b("cart"),m("cart",i),g.set(d("cart")),m("cartQuantity",c),k.set(d("cartQuantity"))}async function j(e){const t=JSON.stringify(e);b("cart"),m("cart",t),g.set(d("cart"));let u=e.reduce(function(r,a){return r+a.quantity},0);m("cartQuantity",u),k.set(d("cartQuantity"))}export{j as a,$ as b,I as h,T as u};
